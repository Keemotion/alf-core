#!/usr/bin/env ruby
$LOAD_PATH.unshift File.expand_path('../../lib', __FILE__)
require "alf"

# 
# Generates a plot
#
# SYNOPSIS
#   #{program_name} #{command_name}
#
# OPTIONS
# #{summarized_options}
#
class Plot < Quickl::Command(__FILE__, __LINE__)
  include Alf::ShortcutOperator

  # Install options
  options do |opt|
    @abscissa = :x
    opt.on('-x abscissa', "Specify abscissa attribute") do |value|
      @abscissa = value.to_sym
    end
    @ordinate = :y
    opt.on('-y ordinate', "Specify ordinate attribute") do |value|
      @ordinate = value.to_sym
    end
    @series = :series
    opt.on('-s series', "Specify series attribute") do |value|
      @series = value.to_sym
    end
  end

  def longexpr
    (group \
      (group \
        (rename @input,
                @abscissa => :x, @ordinate => :y, 
                @series   => :title),
        :data => [:x, :y]),
      :datasets => [:title, :data])
  end

end # class Plot
Plot.run(ARGV, __FILE__) if $0 == __FILE__
